{"version":3,"sources":["../../../../../../client/node_modules/@babel/helper-create-class-features-plugin/lib/misc.js"],"names":["Object","defineProperty","exports","value","injectInitialization","extractComputedKeys","_core","data","require","_helperReplaceSupers","findBareSupers","traverse","visitors","merge","Super","path","node","parentPath","isCallExpression","callee","push","environmentVisitor","referenceVisitor","skip","ReferencedIdentifier","scope","hasOwnBinding","name","rename","classFieldDefinitionEvaluationTDZVisitor","classBinding","getBinding","classNameTDZError","file","addHelper","throwNode","types","callExpression","stringLiteral","replaceWith","sequenceExpression","constructor","nodes","renamer","length","isDerived","superClass","newConstructor","classMethod","identifier","blockStatement","params","restElement","body","template","statement","ast","get","unshiftContainer","bareSupers","bareSuper","insertAfter","ref","computedPaths","declarations","computedPath","id","computedNode","isConstantExpression","ident","generateUidIdentifierBasedOnNode","key","variableDeclaration","variableDeclarator","cloneNode"],"mappings":"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","file":"misc.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.injectInitialization = injectInitialization;\nexports.extractComputedKeys = extractComputedKeys;\n\nfunction _core() {\n  const data = require(\"@babel/core\");\n\n  _core = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _helperReplaceSupers() {\n  const data = require(\"@babel/helper-replace-supers\");\n\n  _helperReplaceSupers = function () {\n    return data;\n  };\n\n  return data;\n}\n\nconst findBareSupers = _core().traverse.visitors.merge([{\n  Super(path) {\n    const {\n      node,\n      parentPath\n    } = path;\n\n    if (parentPath.isCallExpression({\n      callee: node\n    })) {\n      this.push(parentPath);\n    }\n  }\n\n}, _helperReplaceSupers().environmentVisitor]);\n\nconst referenceVisitor = {\n  \"TSTypeAnnotation|TypeAnnotation\"(path) {\n    path.skip();\n  },\n\n  ReferencedIdentifier(path) {\n    if (this.scope.hasOwnBinding(path.node.name)) {\n      this.scope.rename(path.node.name);\n      path.skip();\n    }\n  }\n\n};\n\nconst classFieldDefinitionEvaluationTDZVisitor = _core().traverse.visitors.merge([{\n  ReferencedIdentifier(path) {\n    if (this.classBinding && this.classBinding === path.scope.getBinding(path.node.name)) {\n      const classNameTDZError = this.file.addHelper(\"classNameTDZError\");\n\n      const throwNode = _core().types.callExpression(classNameTDZError, [_core().types.stringLiteral(path.node.name)]);\n\n      path.replaceWith(_core().types.sequenceExpression([throwNode, path.node]));\n      path.skip();\n    }\n  }\n\n}, _helperReplaceSupers().environmentVisitor]);\n\nfunction injectInitialization(path, constructor, nodes, renamer) {\n  if (!nodes.length) return;\n  const isDerived = !!path.node.superClass;\n\n  if (!constructor) {\n    const newConstructor = _core().types.classMethod(\"constructor\", _core().types.identifier(\"constructor\"), [], _core().types.blockStatement([]));\n\n    if (isDerived) {\n      newConstructor.params = [_core().types.restElement(_core().types.identifier(\"args\"))];\n      newConstructor.body.body.push(_core().template.statement.ast`super(...args)`);\n    }\n\n    [constructor] = path.get(\"body\").unshiftContainer(\"body\", newConstructor);\n  }\n\n  if (renamer) {\n    renamer(referenceVisitor, {\n      scope: constructor.scope\n    });\n  }\n\n  if (isDerived) {\n    const bareSupers = [];\n    constructor.traverse(findBareSupers, bareSupers);\n\n    for (const bareSuper of bareSupers) {\n      bareSuper.insertAfter(nodes);\n    }\n  } else {\n    constructor.get(\"body\").unshiftContainer(\"body\", nodes);\n  }\n}\n\nfunction extractComputedKeys(ref, path, computedPaths, file) {\n  const declarations = [];\n\n  for (const computedPath of computedPaths) {\n    computedPath.traverse(classFieldDefinitionEvaluationTDZVisitor, {\n      classBinding: path.node.id && path.scope.getBinding(path.node.id.name),\n      file\n    });\n    const computedNode = computedPath.node;\n\n    if (!computedPath.get(\"key\").isConstantExpression()) {\n      const ident = path.scope.generateUidIdentifierBasedOnNode(computedNode.key);\n      declarations.push(_core().types.variableDeclaration(\"var\", [_core().types.variableDeclarator(ident, computedNode.key)]));\n      computedNode.key = _core().types.cloneNode(ident);\n    }\n  }\n\n  return declarations;\n}"]}