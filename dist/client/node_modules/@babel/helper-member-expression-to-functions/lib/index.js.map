{"version":3,"sources":["../../../../../../client/node_modules/@babel/helper-member-expression-to-functions/lib/index.js"],"names":["Object","defineProperty","exports","value","default","memberExpressionToFunctions","t","data","_interopRequireWildcard","require","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","desc","getOwnPropertyDescriptor","get","set","AssignmentMemoiser","_map","WeakMap","has","record","count","assignmentExpression","handle","memoise","member","node","parent","parentPath","isUpdateExpression","argument","operator","prefix","binaryExpression","unaryExpression","numericLiteral","replaceWith","scope","ref","generateUidIdentifierBasedOnNode","push","id","left","cloneNode","sequenceExpression","isAssignmentExpression","right","slice","isCallExpression","callee","args","arguments","path","visitor","state","traverse","assign","memoiser"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = memberExpressionToFunctions;\n\nfunction t() {\n  const data = _interopRequireWildcard(require(\"@babel/types\"));\n\n  t = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nclass AssignmentMemoiser {\n  constructor() {\n    this._map = new WeakMap();\n  }\n\n  has(key) {\n    return this._map.has(key);\n  }\n\n  get(key) {\n    if (!this.has(key)) return;\n\n    const record = this._map.get(key);\n\n    const {\n      value\n    } = record;\n    record.count--;\n\n    if (record.count === 0) {\n      return t().assignmentExpression(\"=\", value, key);\n    }\n\n    return value;\n  }\n\n  set(key, value, count) {\n    return this._map.set(key, {\n      count,\n      value\n    });\n  }\n\n}\n\nconst handle = {\n  memoise() {},\n\n  handle(member) {\n    const {\n      node,\n      parent,\n      parentPath\n    } = member;\n\n    if (parentPath.isUpdateExpression({\n      argument: node\n    })) {\n      const {\n        operator,\n        prefix\n      } = parent;\n      this.memoise(member, 2);\n      const value = t().binaryExpression(operator[0], t().unaryExpression(\"+\", this.get(member)), t().numericLiteral(1));\n\n      if (prefix) {\n        parentPath.replaceWith(this.set(member, value));\n      } else {\n        const {\n          scope\n        } = member;\n        const ref = scope.generateUidIdentifierBasedOnNode(node);\n        scope.push({\n          id: ref\n        });\n        value.left = t().assignmentExpression(\"=\", t().cloneNode(ref), value.left);\n        parentPath.replaceWith(t().sequenceExpression([this.set(member, value), t().cloneNode(ref)]));\n      }\n\n      return;\n    }\n\n    if (parentPath.isAssignmentExpression({\n      left: node\n    })) {\n      const {\n        operator,\n        right\n      } = parent;\n      let value = right;\n\n      if (operator !== \"=\") {\n        this.memoise(member, 2);\n        value = t().binaryExpression(operator.slice(0, -1), this.get(member), value);\n      }\n\n      parentPath.replaceWith(this.set(member, value));\n      return;\n    }\n\n    if (parentPath.isCallExpression({\n      callee: node\n    })) {\n      const {\n        arguments: args\n      } = parent;\n      parentPath.replaceWith(this.call(member, args));\n      return;\n    }\n\n    member.replaceWith(this.get(member));\n  }\n\n};\n\nfunction memberExpressionToFunctions(path, visitor, state) {\n  path.traverse(visitor, Object.assign({}, handle, state, {\n    memoiser: new AssignmentMemoiser()\n  }));\n}"]}